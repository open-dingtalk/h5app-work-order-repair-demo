(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{195:function(e,t,n){},214:function(e,t,n){},537:function(e,t,n){},539:function(e,t,n){},540:function(e,t,n){},551:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(25),s=n.n(i),r=(n(195),n(6)),l=n(11),o=n(16),d=n(17),u=n(48),j=n.n(u),b=(n(214),n(124)),m=n(47),f=n(8),h=n(15),O=(n(537),n(3)),x=function(){var e=Object(f.f)(),t=function(t){console.log("---path----",t),e(t)};return Object(O.jsxs)("div",{className:"main",children:[Object(O.jsx)("div",{className:"title",children:"\u64cd\u4f5c\u5217\u8868"}),Object(O.jsx)(h.a,{className:"button",block:!0,color:"primary",onClick:function(){t("/edit")},children:"\u914d\u7f6e\u5de5\u5355"}),Object(O.jsx)(h.a,{className:"button",block:!0,color:"primary",onClick:function(){t("/distribute")},children:"\u586b\u5199\u5de5\u5355"})]})},p=n(10),g=n.n(p),v=n(22),k=n(4),N=(n(539),n.p+"static/media/banner.b911a511.png"),y=function(){var e=Object(c.useContext)(R),t=Object(f.f)(),n=h.c.useForm(),a=Object(k.a)(n,1)[0],i=Object(c.useState)(!1),s=Object(k.a)(i,2),r=s[0],l=s[1],o=Object(c.useState)([]),d=Object(k.a)(o,2),u=d[0],b=d[1],m=Object(c.useState)(""),x=Object(k.a)(m,2),p=x[0],y=x[1],C=function(){t("/",{replace:!0})},S=function(t){l(!0);var n={link:p,items:u.map((function(e){return e.value=t[e.id],e}))};j.a.post(e.domain+"/groupRobot/form/submit",n).then((function(e){l(!1),e&&e.data.success?h.b.alert({content:"\u63d0\u4ea4\u6210\u529f!",onConfirm:function(){C()}}):alert("request failed ---\x3e"+JSON.stringify(e))})).catch((function(e){l(!1),alert("httpRequest failed ---\x3e"+JSON.stringify(e))}))},I=function(){var e=Object(v.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.validateFields();case 3:t=e.sent,console.log(t),S(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),F=function(e){return e.items.map((function(e){return Object(O.jsx)(h.c.Item,{name:e.id,label:e.label,rules:[],children:Object(O.jsx)(h.d,{placeholder:"\u8bf7\u8f93\u5165".concat(e.label)})},e.id)}))};return Object(c.useEffect)((function(){!function(){try{var e={},n=localStorage.getItem("form");(n=JSON.parse(n))&&n.items&&n.items.length?(n&&n.items&&n.items.length&&(b(n.items),n.items.forEach((function(t){e[t.id]=t.label}))),y(n?n.link:""),n&&n.link):h.b.alert({content:"\u9700\u8981\u5148\u914d\u7f6e\u5de5\u5355",confirmText:"\u524d\u5f80\u914d\u7f6e",onConfirm:function(){t("/edit")}})}catch(c){console.log("err",c)}}(),a.setFieldsValue({})}),[]),Object(O.jsxs)("div",{className:"page",children:[Object(O.jsx)("div",{className:"navbar-box",children:Object(O.jsx)(h.e,{onBack:C,children:"\u5de5\u5355\u6d3e\u53d1"})}),Object(O.jsx)("div",{className:"page-content",children:Object(O.jsxs)(h.c,{className:"form",form:a,children:[Object(O.jsx)("div",{className:"form-banner",children:Object(O.jsx)("img",{src:N,alt:""})}),Object(O.jsx)(F,{items:u})]})}),Object(O.jsx)("div",{className:"submit-box",children:Object(O.jsx)(h.a,{block:!0,type:"submit",loading:r,color:"primary",onClick:I,children:"\u63d0\u4ea4"})})]})},C=n(5),S=n(552),I=(n(540),n(134)),F=n.n(I),J=n.p+"static/media/1.85a2982e.png",w=n.p+"static/media/2.f5461222.png",q=n.p+"static/media/3.40e5d79a.png",E=n.p+"static/media/4.35c04830.png",A=n.p+"static/media/5.d949fe78.png",B=function(){var e=Object(f.f)(),t=h.c.useForm(),n=Object(k.a)(t,1)[0],a=h.c.useForm(),i=Object(k.a)(a,1)[0],s=Object(c.useState)(!1),r=Object(k.a)(s,2),l=r[0],o=r[1],d=Object(c.useState)([]),u=Object(k.a)(d,2),j=u[0],b=u[1],m=function(e,t){o(!0);try{var n=[];for(var c in t)t[c]&&n.push({id:c,label:t[c]});if(!n.length)return h.b.alert({content:"\u81f3\u5c11\u9700\u8981\u914d\u7f6e\u4e00\u4e2a\u5b57\u6bb5",onConfirm:function(){}}),void o(!1);localStorage.setItem("form",JSON.stringify({link:e,items:n})),h.g.show({content:"\u4fdd\u5b58\u6210\u529f"})}catch(a){console.log("save error:",a)}o(!1)},x=function(){var e=Object(v.a)(g.a.mark((function e(){var t,c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.validateFields();case 3:return t=e.sent,e.next=6,n.validateFields();case 6:c=e.sent,a=t.link,m(a,c),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=function(){try{var e={},t=localStorage.getItem("form");if((t=JSON.parse(t))&&t.items&&t.items.length)b(t.items),t.items.forEach((function(t){e[t.id]=t.label}));else{var n=[{id:"001",label:"\u5de5\u5355\u7f16\u53f7"},{id:"002",label:"\u7ef4\u4fee\u5de5\u7a0b\u5e08\u59d3\u540d"},{id:"003",label:"\u4ea7\u54c1\u578b\u53f7"},{id:"004",label:"\u6545\u969c\u73b0\u8c61"},{id:"005",label:"\u5907\u6ce8"}];b(n),n.forEach((function(t){e[t.id]=t.label}))}return{link:t?t.link:"",values:e}}catch(c){console.log("err",c)}}();i.setFieldsValue({link:e.link||""}),n.setFieldsValue(e.values)}),[i,n]);var p=function(e){return e.items.map((function(t,n){return Object(O.jsxs)("div",{children:[Object(O.jsx)(h.c.Item,{name:t.id,label:"\u5b57\u6bb5\u540d\u79f0",rules:[],children:Object(O.jsx)(h.d,{placeholder:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0"})}),Object(O.jsx)(S.a,{className:"del-btn",onClick:function(){return e.delItems(n)}})]},t.id)}))},N=[J,w,q,E,A].map((function(e,t){return Object(O.jsx)(h.f.Item,{children:Object(O.jsxs)("div",{className:"swiper-item-box",children:[Object(O.jsx)("div",{className:"mask"}),Object(O.jsx)("img",{src:e,alt:""})]})},t)}));return Object(O.jsxs)("div",{className:"page page-edit",children:[Object(O.jsx)("div",{className:"navbar-box",children:Object(O.jsx)(h.e,{onBack:function(){e("/",{replace:!0})},children:"\u914d\u7f6e\u5de5\u5355"})}),Object(O.jsxs)("div",{className:"page-content",children:[Object(O.jsxs)("section",{children:[Object(O.jsx)("h4",{children:"\u7b2c\u4e00\u6b65\uff1a\u914d\u7f6e\u7fa4\u673a\u5668\u4eba"}),Object(O.jsx)(h.f,{loop:!0,children:N})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("h4",{children:"\u7b2c\u4e8c\u6b65\uff1a\u914d\u7f6e\u7fa4\u673a\u5668\u4eba\u94fe\u63a5"}),Object(O.jsx)(h.c,{className:"form",form:i,children:Object(O.jsx)(h.c.Item,{name:"link",label:"\u673a\u5668\u4eba\u94fe\u63a5",rules:[{required:!0,message:"\u6b64\u9879\u5fc5\u586b"}],children:Object(O.jsx)(h.d,{placeholder:"\u8bf7\u8f93\u5165\u673a\u5668\u4eba\u94fe\u63a5"})})})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("h4",{children:"\u7b2c\u4e09\u6b65\uff1a\u5de5\u5355\u7ec4\u4ef6\uff0c\u8be6\u7ec6\u5de5\u5355diy\u8bf7\u5f00\u901a\u201d\u756a\u8304\u8868\u5355\u201c\u4f53\u9a8c"}),Object(O.jsxs)(h.c,{className:"form",form:n,children:[!!j.length&&Object(O.jsx)(p,{items:j,delItems:function(e){j.splice(e,1),b(Object(C.a)(j))}}),Object(O.jsx)("div",{className:"add-item",children:Object(O.jsx)(h.a,{block:!0,onClick:function(){b(j.concat({id:F.a.generate()}))},children:"\u6dfb\u52a0\u5b57\u6bb5"})})]})]})]}),Object(O.jsx)("div",{className:"submit-box",children:Object(O.jsx)(h.a,{block:!0,type:"submit",loading:l,color:"primary",onClick:x,children:"\u4fdd\u5b58"})})]})};function T(){return Object(O.jsx)(m.a,{children:Object(O.jsxs)(f.c,{children:[Object(O.jsx)(f.a,{path:"/",element:Object(O.jsx)(x,{})}),Object(O.jsx)(f.a,{path:"/home",element:Object(O.jsx)(x,{})}),Object(O.jsx)(f.a,{path:"/distribute",element:Object(O.jsx)(y,{})}),Object(O.jsx)(f.a,{path:"/edit",element:Object(O.jsx)(B,{})})]})})}var R=a.a.createContext({domain:""}),V=function(e){Object(o.a)(n,e);var t=Object(d.a)(n);function n(e){var c;return Object(r.a)(this,n),(c=t.call(this,e)).state={domain:"",corpId:"",authCode:"",userId:"",userName:""},c}return Object(l.a)(n,[{key:"render",value:function(){return""===this.state.userId&&this.login(),Object(O.jsx)("div",{className:"App",children:Object(O.jsx)(T,{})})}},{key:"login",value:function(){var e=this;j.a.get(this.state.domain+"/getCorpId").then((function(t){t.data&&e.loginAction(t.data)})).catch((function(e){alert("corpId err, "+JSON.stringify(e))}))}},{key:"loginAction",value:function(e){var t=this;b.runtime.permission.requestAuthCode({corpId:e,onSuccess:function(e){t.state.authCode=e.code,j.a.get(t.state.domain+"/login?authCode="+t.state.authCode).then((function(e){if(e&&e.data.success){var n=e.data.data.userId,c=e.data.data.userName;alert("\u767b\u5f55\u6210\u529f\uff0c\u4f60\u597d"+c),setTimeout((function(){t.setState({userId:n,userName:c})}),0)}else alert("login failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("httpRequest failed ---\x3e"+JSON.stringify(e))}))},onFail:function(e){alert("requestAuthCode failed ---\x3e"+JSON.stringify(e))}})}}]),n}(a.a.Component),L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,553)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(V,{})}),document.getElementById("root")),L()}},[[551,1,2]]]);
//# sourceMappingURL=main.560fbda7.chunk.js.map